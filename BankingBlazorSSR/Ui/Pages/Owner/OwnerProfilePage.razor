@page "/owners/profile"
@inherits BankingBlazorSsr.Ui.Common.BasePage

@* @attribute [Authorize] *@
@* @attribute [Authorize(Roles = "Owner")] *@


<PageTitle>Kundenprofil</PageTitle>

<div class="container py-4" style="max-width: 860px;">
    <div class="mb-3">
        <h1 class="h3 mb-1">Profil Kontoinhaber</h1>
    </div>

    @if (Loading) {
        <p>Lade …</p>
    }
    else {
        <EditForm EditContext="_editContext" OnValidSubmit="SaveAsync" novalidate>
            <DataAnnotationsValidator/>

            @* Global validation *@
            @if (_showGlobalErrors) {
                <div class="alert alert-danger" role="alert">
                    <div class="fw-semibold mb-1">Eingaben prüfen</div>
                    <ValidationSummary/>
                </div>
            }
            <!-- Basisdaten -->
            <div class="card shadow-sm mb-3">
                <div class="card-body">
                    <div class="row g-3">
                        <!-- Vorname: 50% width (on desktop) -->
                        <div class="col-md-6">
                            <InputFieldString Id="firstname"
                                              Label="Vorname"
                                              @bind-Value="_ownerDto.Firstname"
                                              Placeholder="dein Vorname ..."/>
                        </div>
                        <!-- Vorname: 50% width on desktop -->
                        <div class="col-md-6">
                            <InputFieldString Id="lastname"
                                              Label="Nachname"
                                              @bind-Value="_ownerDto.Lastname"
                                              Placeholder="dein Nachname ..."/>
                        </div>
                        <div class="col-12">
                            <InputFieldString Id="email" 
                                              Label="E-Mail" 
                                              Placeholder="E-Mail" 
                                              Type="email"
                                              @bind-Value="_ownerDto.Email"/>
                            @* <div class="form-text mt-0"> *@
                            @*     Diese E-Mail stammt aus dem Login und kann angepasst werden. *@
                            @* </div> *@
                        </div>
                    </div>
                </div>
            </div>

            <!-- Adresse -->
            <div class="card shadow-sm mb-3">
                <div class="card-body">
                    <h2 class="h6 text-muted mb-3">Adresse (optional)</h2>
                    <div class="row g-3">
                        <div class="col-12">
                            <InputFieldString Id="street" 
                                              Label="Straße" 
                                              Placeholder="Straße"
                                              @bind-Value="_ownerDto.Street"/>
                        </div>

                        <div class="col-md-4">
                            <InputFieldString Id="zip" 
                                              Label="PLZ" 
                                              Placeholder="PLZ"
                                              @bind-Value="_ownerDto.PostalCode"/>
                        </div>

                        <div class="col-md-8">
                            <InputFieldString Id="city" 
                                              Label="Ort" 
                                              Placeholder="Ort"
                                              @bind-Value="_ownerDto.City"/>
                        </div>

                        <div class="col-md-6">
                            <InputFieldString Id="country"
                                              Label="Land" 
                                              Placeholder="Land"
                                              @bind-Value="_ownerDto.Country"/>
                        </div>
                    </div>
                    
                    @if (!string.IsNullOrWhiteSpace(_saveError)) {
                        <div class="alert alert-danger" role="alert">@_saveError</div>
                    }
                    @if (!string.IsNullOrWhiteSpace(_saveOk)) {
                        <div class="alert alert-success" role="alert">@_saveOk</div>
                    }

                    <div class="d-flex justify-content-center mt-3">
                        <ButtonsCancelLeaveSubmit
                            OnSubmit="SaveAsync"
                            OnCancel="Cancel" />
                    </div>
                </div>
            </div>
        </EditForm>
    }
</div>
