@using System.Diagnostics.CodeAnalysis

@inherits InputBase<int>

<div class="form-floating mb-3">
    <input type="number" 
           class="form-control @CssClass" 
           id="@Id" 
           placeholder="@Placeholder" 
           value="@CurrentValueAsString" 
           @oninput="OnInput"
           @attributes="AdditionalAttributes" />
    <label for="@Id">@Label</label>
    <ValidationMessage For="@(() => CurrentValue)" class="text-danger small"/>
</div>

@code {
  [Parameter] public string Id { get; set; } = string.Empty;
  [Parameter] public string Label { get; set; } = string.Empty;
  [Parameter] public string Placeholder { get; set; } = string.Empty;
  
  // Type defaults to "number" for int
  
  protected override bool TryParseValueFromString(
    string? value, 
    out int result, 
    [NotNullWhen(false)] out string? validationErrorMessage
  ) {
    if (int.TryParse(value, out result))
    {
        validationErrorMessage = null;
        return true;
    }
    
    result = 0;
    validationErrorMessage = "Der eingegebene Wert ist keine g√ºltige Zahl.";
    return false;
  }
  
  private void OnInput(ChangeEventArgs e) {
    // CurrentValueAsString triggers parsing
    CurrentValueAsString = e.Value?.ToString();
  }
}
